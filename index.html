<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cox Risk Calculator (Updated)</title>

    <!-- 1. React and Libraries via CDN -->
    <script src="./react.js"></script>
    <script src="./react-dom.js"></script>
    <script src="./babel.js"></script>
      
    <!-- 2. Tailwind CSS -->
    <script src="./tailwind.js"></script>

    <!-- 3. Custom Styles -->
    <style>
        body { background-color: #f8fafc; }
        .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 300ms; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const IconActivity = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-8 h-8 text-white"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
        );

        const IconCalculator = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-5 h-5 mr-2 text-blue-600"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
        );
        const IconRefresh = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-4 h-4 mr-1"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
        );
        const IconCalendar = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-6 h-6 text-slate-400"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
        );
        const IconAlert = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="w-12 h-12 mx-auto mb-2 opacity-20"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
        );

        // --- UPDATED MODEL DATA ---
        // Features reduced to: vascular_access_1, ALP, Ferritin, sex_m, twCAVI, creatinine
        const DEFAULT_MODEL_DATA = {
            "features": [
                "vascular_access_1",
                "ALP",
                "Ferritin",
                "sex_m",
                "twCAVI",
                "creatinine"
            ],
            "coefficients": {
                "vascular_access_1": 0.5163,
                "ALP": 0.0109,
                "Ferritin": 0.0019,
                "sex_m": 0.9405,
                "twCAVI": 0.0021,
                "creatinine": -0.1389
            },
            "training_means": {
                "vascular_access_1": 0.2872,
                "ALP": 77.299,
                "Ferritin": 275.4054,
                "sex_m": 0.5319,
                "twCAVI": 175.7101,
                "creatinine": 9.0441
            },
            "baseline_survival": [
                { "time": 1.0, "survival_prob": 0.9923 },
                { "time": 2.0, "survival_prob": 0.9842 },
                { "time": 4.0, "survival_prob": 0.976 },
                { "time": 5.0, "survival_prob": 0.9677 },
                { "time": 6.0, "survival_prob": 0.943 },
                { "time": 9.0, "survival_prob": 0.9345 },
                { "time": 10.0, "survival_prob": 0.9253 },
                { "time": 11.0, "survival_prob": 0.916 },
                { "time": 12.0, "survival_prob": 0.8975 },
                { "time": 13.0, "survival_prob": 0.8881 },
                { "time": 15.0, "survival_prob": 0.8785 },
                { "time": 16.0, "survival_prob": 0.8593 },
                { "time": 19.0, "survival_prob": 0.8391 },
                { "time": 20.0, "survival_prob": 0.8078 },
                { "time": 21.0, "survival_prob": 0.797 },
                { "time": 22.0, "survival_prob": 0.7863 },
                { "time": 23.0, "survival_prob": 0.7757 },
                { "time": 24.0, "survival_prob": 0.7444 },
                { "time": 27.0, "survival_prob": 0.7236 },
                { "time": 28.0, "survival_prob": 0.7128 },
                { "time": 31.0, "survival_prob": 0.6908 },
                { "time": 32.0, "survival_prob": 0.6688 },
                { "time": 34.0, "survival_prob": 0.6578 },
                { "time": 35.0, "survival_prob": 0.6359 },
                { "time": 36.0, "survival_prob": 0.6133 },
                { "time": 37.0, "survival_prob": 0.6015 },
                { "time": 38.0, "survival_prob": 0.5672 },
                { "time": 39.0, "survival_prob": 0.5554 },
                { "time": 40.0, "survival_prob": 0.5436 },
                { "time": 41.0, "survival_prob": 0.5201 },
                { "time": 46.0, "survival_prob": 0.5084 },
                { "time": 47.0, "survival_prob": 0.4967 },
                { "time": 48.0, "survival_prob": 0.4851 },
                { "time": 52.0, "survival_prob": 0.4734 },
                { "time": 54.0, "survival_prob": 0.4613 },
                { "time": 56.0, "survival_prob": 0.4374 },
                { "time": 57.0, "survival_prob": 0.4242 },
                { "time": 58.0, "survival_prob": 0.4109 },
                { "time": 61.0, "survival_prob": 0.3978 },
                { "time": 63.0, "survival_prob": 0.3847 },
                { "time": 65.0, "survival_prob": 0.3718 },
                { "time": 67.0, "survival_prob": 0.3587 },
                { "time": 70.0, "survival_prob": 0.3454 },
                { "time": 73.0, "survival_prob": 0.32 },
                { "time": 76.0, "survival_prob": 0.3072 },
                { "time": 81.0, "survival_prob": 0.2935 },
                { "time": 92.0, "survival_prob": 0.2798 },
                { "time": 100.0, "survival_prob": 0.2664 },
                { "time": 101.0, "survival_prob": 0.2664 },
                { "time": 103.0, "survival_prob": 0.2381 },
                { "time": 104.0, "survival_prob": 0.2381 },
                { "time": 105.0, "survival_prob": 0.2381 },
                { "time": 106.0, "survival_prob": 0.2381 }
            ]
        };

        // --- UPDATED FIELD CONFIG ---
        // Removed: P, PTH, Fib
        // Kept: sex_m, vascular_access_1, creatinine, ALP, Ferritin
        const FIELD_CONFIG = {
            "sex_m": { 
                label: "Sex", 
                type: "select", 
                options: [{val: 1, text: "Male"}, {val: 0, text: "Female"}] 
            },
            "vascular_access_1": { 
                label: "Vascular Access", 
                type: "select", 
                options: [{val: 1, text: "Central Venous Catheter [CVC]"}, {val: 0, text: "Arteriovenous Fistula [AVF]"}] 
            },
            // Numeric inputs with validation limits
            "creatinine": { label: "Creatinine (mg/dL)", type: "number", step: 0.1, min: 0.1, max: 30.0 },
            "ALP": { label: "Alkaline Phosphatase (U/L)", type: "number", step: 1, min: 10, max: 2000 },
            "Ferritin": { label: "Ferritin (ng/mL)", type: "number", step: 1, min: 1, max: 10000 },
        };

        // Configuration for manual inputs (CAVI and Time)
        const MANUAL_INPUT_CONFIG = {
            cavi: { min: 1.0, max: 20.0, step: 0.1, label: "CAVI Value" },
            time: { min: 0.0, max: 600.0, step: 0.1, label: "Time (Months)" }
        };
        
        // --- HELPER FUNCTIONS ---
        // Helper to convert string inputs with commas or dots into valid floats
        const parseInput = (val) => {
            if (typeof val === 'number') return val;
            if (!val) return 0;
            // Replace comma with dot, then parse
            const normalized = val.toString().replace(',', '.');
            const parsed = parseFloat(normalized);
            return isNaN(parsed) ? 0 : parsed;
        };

        // --- APP COMPONENT ---
        function App() {
            // State for the Model itself (Dynamic!)
            const [acceptedDisclaimer, setAcceptedDisclaimer] = useState(false);
            const [modelData, setModelData] = useState(DEFAULT_MODEL_DATA);
            
            // Changed state init to strings/empty to allow typing
            const [inputs, setInputs] = useState({});
            const [targetTime, setTargetTime] = useState(30);
            const [result, setResult] = useState(null);
            
            // twCAVI manual inputs (kept as raw inputs)
            const [caviVal, setCaviVal] = useState("");
            const [caviTiming, setCaviTiming] = useState("");

            // Initialize on mount
            useEffect(() => {
                resetValues(DEFAULT_MODEL_DATA);
            }, []);

            // Automatically update twCAVI when raw inputs change
            useEffect(() => {
                // Parse inputs safely before calculating
                const val = parseInput(caviVal);
                const timing = parseInput(caviTiming);
                const calculatedTwCAVI = val * timing;
                
                setInputs(prev => ({
                    ...prev,
                    twCAVI: calculatedTwCAVI
                }));
            }, [caviVal, caviTiming]);

            // Now accepts specific model data argument
            const resetValues = (currentModel = modelData) => {
                const initialValues = {};
                currentModel.features.forEach(feat => {
                    if (feat === 'sex_m') initialValues[feat] = 1; 
                    else if (feat === 'vascular_access_1') initialValues[feat] = 0;
                    else initialValues[feat] = parseFloat(currentModel.training_means[feat].toFixed(2));
                });
                
                // Handle twCAVI Reset based on CURRENT model means
                const meanTwCAVI = currentModel.training_means['twCAVI'];
                const defaultCavi = 8.0; 
                const defaultTiming = meanTwCAVI / defaultCavi; 

                setCaviVal(defaultCavi.toFixed(1)); // Convert to string for input
                setCaviTiming(defaultTiming.toFixed(2));
                
                initialValues['twCAVI'] = meanTwCAVI; 

                setInputs(initialValues);
                setResult(null);
            };

            const handleInputChange = (feature, value) => {
                setInputs(prev => ({
                    ...prev,
                    [feature]: value // Store raw string to allow editing with comma
                }));
            };


            const calculateRisk = () => {
                const { features, coefficients, training_means, baseline_survival } = modelData;
                
                let logPartialHazard = 0;

                // Check Manual Inputs (CAVI & Time) first
                const currentCavi = parseInput(caviVal);
                const currentTime = parseInput(caviTiming);

                // Check CAVI limits
                if (currentCavi < MANUAL_INPUT_CONFIG.cavi.min || currentCavi > MANUAL_INPUT_CONFIG.cavi.max) {
                    alert(`Value for ${MANUAL_INPUT_CONFIG.cavi.label} is out of range. \nPlease enter a value between ${MANUAL_INPUT_CONFIG.cavi.min} and ${MANUAL_INPUT_CONFIG.cavi.max}.`);
                    return;
                }
                // Check Time limits
                if (currentTime < MANUAL_INPUT_CONFIG.time.min || currentTime > MANUAL_INPUT_CONFIG.time.max) {
                    alert(`Value for ${MANUAL_INPUT_CONFIG.time.label} is out of range. \nPlease enter a value between ${MANUAL_INPUT_CONFIG.time.min} and ${MANUAL_INPUT_CONFIG.time.max}.`);
                    return;
                }

                // Before calculating, check if values are within reasonable limits
                for (let feature of features) {
                    // Skip features that are not in FIELD_CONFIG (like twCAVI handled separately)
                    if (FIELD_CONFIG[feature] && FIELD_CONFIG[feature].type === 'number') {
                        const val = parseInput(inputs[feature]);
                        const conf = FIELD_CONFIG[feature];
                        
                        // Check Min
                        if (conf.min !== undefined && val < conf.min) {
                            alert(`Value for ${conf.label} is too low. Minimum allowed is ${conf.min}.`);
                            return; // Stop calculation
                        }
                        // Check Max
                        if (conf.max !== undefined && val > conf.max) {
                            alert(`Value for ${conf.label} is too high. Maximum allowed is ${conf.max}.`);
                            return; // Stop calculation
                        }
                    }
                }

                features.forEach(feature => {
                    // Parse the input (string or number) to float
                    const userValue = parseInput(inputs[feature]);
                    const meanVal = training_means[feature];
                    const beta = coefficients[feature];
                    logPartialHazard += (userValue - meanVal) * beta;
                });

                const partialHazard = Math.exp(logPartialHazard);

                let baselineS0 = 1.0;
                // Ensure sorting
                const sortedBaseline = [...baseline_survival].sort((a, b) => a.time - b.time);
                
                // Logic: find the latest time point <= targetTime (Step function)
                for (let point of sortedBaseline) {
                    if (point.time <= targetTime) {
                        baselineS0 = point.survival_prob;
                    } else {
                        // Since it is sorted, as soon as we exceed targetTime, 
                        // the previous point was the correct step. We stop.
                        break; 
                    }
                }

                const survivalProb = Math.pow(baselineS0, partialHazard);
                const riskProb = 1 - survivalProb;

                setResult(riskProb);
            };

            if (!acceptedDisclaimer) {
                return (
                    <div className="fixed inset-0 bg-slate-900 bg-opacity-70 flex items-center justify-center p-4 z-50">
                        <div className="bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 text-center">
                            <IconAlert />
                            <h2 className="text-2xl font-bold text-slate-800 mb-4">Research Use Only</h2>
                            <div className="text-left text-slate-600 space-y-4 text-sm mb-8 overflow-y-auto max-h-60 border p-4 rounded bg-slate-50">
                                <p><strong>Important Legal Notice:</strong></p>
                                <p>This software is a prototype designed exclusively for <strong>scientific research and educational demonstration</strong>.</p>
                                <p>It is NOT a CE-marked Medical Device. It implies <strong>NO doctor-patient relationship</strong>.</p>
                                <p><strong>Data Privacy:</strong> This application runs entirely in your browser. Clinical values entered are NOT sent to any server. Hosting infrastructure (Vercel) processes connection data for security only.</p>
                                <p>By proceeding, you acknowledge that you are a healthcare professional or researcher and agree to use this tool solely for experimental purposes at your own risk.</p>
                            </div>
                            <button 
                                onClick={() => setAcceptedDisclaimer(true)}
                                className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl transition-colors"
                            >
                                I Understand & Agree
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-50 p-4 md:p-8 font-sans text-slate-800">
                    <div className="max-w-4xl mx-auto space-y-6">
                        
                        {/* Header */}
                        <header className="flex flex-col md:flex-row justify-between items-center pb-6 border-b border-slate-200 gap-4">
                            <div className="flex items-center space-x-3 w-full md:w-auto">
                                <div className="p-3 bg-blue-600 rounded-lg shadow-lg">
                                    <IconActivity />
                                </div>
                                <div>
                                    <h1 className="text-2xl font-bold text-slate-900">Haemodialysis Prognostic Estimator (twCAVI)</h1>
                                    <p className="text-slate-500 text-sm">Risk assessment of mortality using Time-Weighted Cardio-Ankle Vascular Index
</p>
                                </div>
                            </div>
                        </header>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            
                            {/* Input Column */}
                            <div className="lg:col-span-2 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-lg font-semibold flex items-center">
                                        <IconCalculator />
                                        Patient Parameters
                                    </h2>
                                    <button 
                                        onClick={() => resetValues(modelData)}
                                        className="text-sm text-slate-400 hover:text-blue-600 flex items-center transition-colors"
                                    >
                                        <span className="flex items-center"><IconRefresh /> Reset to Means</span>
                                    </button>
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    
                                    {/* Feature Loop - Uses dynamic modelData */}
                                    {modelData.features.map(feature => {
                                        if (feature === 'twCAVI') return null; 

                                        const config = FIELD_CONFIG[feature] || { label: feature, type: "number", step: 0.1 };

                                        return (
                                            <div key={feature} className="space-y-1">
                                                <label className="text-xs font-bold uppercase tracking-wider text-slate-500 mb-1 min-h-[2.5rem] flex items-end">
                                                    {/* Wrapper span: mantiene il testo e il range uniti nel flusso naturale */}
                                                    <span className="w-full leading-tight">
                                                        {config.label} 
                                                        {config.type === 'number' && (
                                                            <span className="ml-1 text-[10px] font-normal lowercase text-slate-400">
                                                                ({config.min} - {config.max})
                                                            </span>
                                                        )}
                                                    </span>
                                                </label>
                                                {config.type === 'select' ? (
                                                    <select
                                                        value={inputs[feature] || 0}
                                                        onChange={(e) => handleInputChange(feature, e.target.value)}
                                                        className="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                                                    >
                                                        {config.options.map(opt => (
                                                            <option key={opt.val} value={opt.val}>{opt.text}</option>
                                                        ))}
                                                    </select>
                                                ) : (
                                                    <input
                                                        type="number" // Changed from 'text' to 'number' for browser UI controls
                                                        inputMode="decimal"
                                                        // Pass constraints to HTML input for browser validation UI
                                                        min={config.min}
                                                        max={config.max}
                                                        step={config.step}
                                                        value={inputs[feature] || ''}
                                                        onChange={(e) => handleInputChange(feature, e.target.value)}
                                                        className="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                                                    />
                                                )}
                                            </div>
                                        );
                                    })}

                                    {/* MANUAL BLOCK: twCAVI */}
                                    <div className="col-span-1 md:col-span-2 p-4 bg-blue-50 rounded-lg border border-blue-100 mt-2">
                                        <h3 className="text-sm font-bold text-blue-800 mb-3 uppercase tracking-wide">CAVI & Timing Calculation</h3>
                                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            
                                            {/* CAVI Input */}
                                            <div className="space-y-1">
                                                <label className="block text-xs font-bold uppercase tracking-wider text-slate-500">
                                                    CAVI Value
                                                    <span className="ml-1 text-[10px] font-normal lowercase text-slate-400">
                                                        ({MANUAL_INPUT_CONFIG.cavi.min} - {MANUAL_INPUT_CONFIG.cavi.max})
                                                    </span>
                                                </label>
                                                <input
                                                    type="number" // Use number type for browser UI controls
                                                    inputMode="decimal"
                                                    min={MANUAL_INPUT_CONFIG.cavi.min}
                                                    max={MANUAL_INPUT_CONFIG.cavi.max}
                                                    step={MANUAL_INPUT_CONFIG.cavi.step}
                                                    value={caviVal}
                                                    onChange={(e) => setCaviVal(e.target.value)}
                                                    className="w-full p-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                                />
                                            </div>

                                            {/* Time Input */}
                                            <div className="space-y-1">
                                                <label className="block text-xs font-bold uppercase tracking-wider text-slate-500">
                                                    Time (*)
                                                    <span className="ml-1 text-[10px] font-normal lowercase text-slate-400">
                                                        ({MANUAL_INPUT_CONFIG.time.min} - {MANUAL_INPUT_CONFIG.time.max})
                                                    </span>
                                                </label>
                                                <input
                                                    type="number" // Use number type
                                                    inputMode="decimal"
                                                    min={MANUAL_INPUT_CONFIG.time.min}
                                                    max={MANUAL_INPUT_CONFIG.time.max}
                                                    step={MANUAL_INPUT_CONFIG.time.step}
                                                    value={caviTiming}
                                                    onChange={(e) => setCaviTiming(e.target.value)}
                                                    className="w-full p-2 bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                                />
                                                <p className="text-[10px] text-slate-400 leading-tight">
                                                    (*) Time in months from haemodialysis initiation to the CAVI measurement.
                                                </p>
                                            </div>

                                            {/* Calculated Result Display (No changes here needed) */}
                                            <div className="space-y-1">
                                                <label className="block text-xs font-bold uppercase tracking-wider text-blue-400">
                                                    Calculated twCAVI
                                                </label>
                                                <div className="w-full p-2 bg-blue-100 border border-blue-200 rounded-lg text-blue-800 font-mono text-center">
                                                    {parseInput(inputs['twCAVI']).toFixed(1)}
                                                </div>
                                                <p className="text-[10px] text-blue-400 text-center leading-tight">CAVI Ã— Time</p>
                                            </div>

                                        </div>
                                    </div>
                                </div>

                                <div className="mt-8 pt-6 border-t border-slate-100">
                                    <label className="block text-xs font-bold uppercase tracking-wider text-slate-500 mb-2">
                                        Time Horizon (Months)
                                    </label>
                                    <div className="flex items-center space-x-4">
                                        <IconCalendar />
                                        <input 
                                            type="range" 
                                            min="1" 
                                            max="100" 
                                            value={targetTime} 
                                            onChange={(e) => setTargetTime(parseInt(e.target.value))}
                                            className="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600"
                                        />
                                        <span className="text-xl font-bold text-slate-700 w-16 text-center">{targetTime}</span>
                                    </div>
                                </div>

                                <button
                                    onClick={calculateRisk}
                                    className="mt-8 w-full py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-0.5"
                                >
                                    Calculate Risk
                                </button>
                            </div>

                            {/* Results Column */}
                            <div className="lg:col-span-1 space-y-6">
                                <div className={`bg-white rounded-xl shadow-sm border border-slate-200 p-6 transition-all duration-500 ${result !== null ? 'opacity-100 translate-y-0' : 'opacity-50 translate-y-4'}`}>
                                    <h3 className="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2">
                                        Estimated Risk
                                    </h3>
                                    
                                    {result !== null ? (
                                        <div className="text-center py-6">
                                            <div className="text-5xl font-extrabold text-slate-800 mb-2">
                                                {(result * 100).toFixed(2)}%
                                            </div>
                                            <p className="text-slate-500 text-sm">
                                                Probability of event at {targetTime} months
                                            </p>
                                            
                                            <div className="mt-6 w-full bg-slate-100 h-3 rounded-full overflow-hidden">
                                                <div 
                                                    className={`h-full transition-all duration-1000 ease-out ${result < 0.3 ? 'bg-green-500' : result < 0.6 ? 'bg-yellow-500' : 'bg-red-500'}`}
                                                    style={{ width: `${result * 100}%` }}
                                                />
                                            </div>
                                            <div className="flex justify-between text-xs text-slate-400 mt-1">
                                                <span>0%</span>
                                                <span>50%</span>
                                                <span>100%</span>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="text-center py-10 text-slate-400">
                                            <IconAlert />
                                            <p>Input data to calculate</p>
                                        </div>
                                    )}
                                </div>

                                <div className="bg-slate-100 rounded-xl p-5 text-sm text-slate-600 border border-slate-200">
                                    <h4 className="font-bold text-slate-700 mb-2">Methodology Note</h4>
                                    <p className="mb-2">
                                        This model utilizes Cox Proportional Hazards regression.
                                    </p>
                                    <p>
                                        Pre-filled fields represent the <strong>mean values</strong> of the current loaded model. Leaving them unchanged neutralizes that variable's effect on the risk score.
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* DISCLAIMER FOOTER (NEW) */}
                        <footer className="mt-8 pt-6 border-t border-slate-200">
                            <div className="bg-slate-100 border border-slate-200 rounded-lg p-4 text-xs text-slate-600 text-center">
                                {/* Medical Disclaimer */}
                                <p className="font-bold uppercase mb-1">Disclaimer: Experimental and Educational Use Only</p>
                                <p className="mb-4">
                                    This software is designed for research, experimental, and educational purposes. It has not been validated for clinical use and is not intended to be a substitute for professional medical advice, diagnosis, or treatment. 
                                    The risk estimates provided are based on statistical models and should not be used for clinical decision-making. 
                                    The authors and developers assume no liability for any direct or indirect consequences arising from the use of this application.
                                </p>
                                <div className="w-full h-px bg-slate-200 my-3"></div>
                                {/* Privacy & GDPR*/}
                                <p className="text-[10px] text-slate-500 leading-tight">
                                    <strong>Privacy & GDPR Notice:</strong> This application functions as a "Client-Side SPA". 
                                    Patient clinical data entered in the form remains exclusively in your browser's memory (RAM) and is <strong>never transmitted</strong> to the developers, databases, or third parties. 
                                    <br/><br/>
                                    <strong>Infrastructure & Hosting:</strong> This site is hosted by <strong>Vercel Inc. (USA)</strong>. 
                                    While Vercel does not access the input data, they may collect technical access logs (IP address, User Agent) for security, fraud prevention, and performance monitoring purposes. 
                                    By using this tool, you acknowledge this technical data processing.
                                    The application does not use profiling cookies.                                     
                                </p>
                            </div>
                        </footer>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
